---
import Layout from "../layouts/Layout.astro";
const pageTitle = "Jhon Arciniegas | Blog";

type Post = {
  frontmatter: {
    title: string;
    date: string;
  };
  url: string;
};

// Cargar todos los posts en /src/pages/posts/*.md
const allPosts = import.meta.glob("/src/pages/posts/*.md", { eager: true });

// Crear lista de posts con URL correcta
const posts = Object.entries(allPosts).map(([path, mod]) => {
  const post = mod as Post;
  // Extraer el nombre del archivo sin extensión para formar la URL
  const fileName = path.split("/").pop()?.replace(".md", "") || "";
  return {
    ...post,
    url: `/posts/${fileName}`,
  };
});

// Ordenar posts del más nuevo al más viejo
const reversedPostList = posts.sort(
  (a, b) =>
    new Date(b.frontmatter.date).getTime() -
    new Date(a.frontmatter.date).getTime()
);
---

<Layout title={pageTitle}>
  <section class="max-w-4xl mx-auto py-6">
    <header class="mb-12">
      <h1 class="text-3xl sm:text-4xl font-bold text-cyan-300 tracking-tight">
        Blog Posts
      </h1>
      <p class="mt-3 text-gray-400 text-sm uppercase tracking-widest">
        thoughts, dev notes & ideas
      </p>
    </header>

    <ul class="space-y-4">
      {
        reversedPostList.map((post) => (
          <li class="border-l-4 border-lime-300 pl-2 transition-colors rounded-md group">
            <a
              href={post.url}
              class="block text-lg font-medium text-neutral-200 group-hover:text-lime-300"
            >
              {post.frontmatter.title}
            </a>
            <p class="mt-1 text-sm text-neutral-400">{post.frontmatter.date}</p>
          </li>
        ))
      }
    </ul>
  </section>
</Layout>
